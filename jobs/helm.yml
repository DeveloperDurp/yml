.helm-build:
  image: dtzar/helm-kubectl
  script:
    # Begin of helm-package.sh
    - |
      #Helm Package
      for chart in charts/*; do
        if [ -d "$chart" ]; then
          helm dependency update $chart
          helm package "$chart" -d ./packages --version ${VERSION}
        fi
      done
    # End of helm-package.sh
.helm-push:
  image: dtzar/helm-kubectl
  script:
    # Begin of helm-login.sh
    - |
      #Helm login
      helm registry login ${CI_REGISTRY} -u gitlab-ci-token -p ${CI_JOB_TOKEN}
    # End of helm-login.sh

    # Begin of helm-push.sh
    - "#Helm Push    \n    \nfor chart in packages/*; do\n    helm push ./$chart oci://$CI_REGISTRY/$CI_PROJECT_PATH\ndone\n"
    # End of helm-push.sh
